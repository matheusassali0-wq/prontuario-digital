# PENTEST.md — Plano de Testes

1. Headers/CSP: injetar `<script>` e `<iframe>` — deve bloquear. HEAD `/` retorna todos os headers.
2. COOP/COEP: `crossOriginIsolated` deve ser verdade com HTTPS + headers.
3. KDF: remover `public/argon2` e observar fallback PBKDF2; adicionar e verificar que `KDF.mode` vira `argon2id`.
4. Vault: PUT/GET sem Authorization → 401; com apiKey incorreta → 401; com correta → 200.
5. Data at rest: IndexedDB `kv`/`auditEnc` estão cifrados (GCM); chaves mapeadas por hash(sal+chave).
6. N‑gram index: buscar substring presente → retorna; substring ausente → não retorna.
7. MFA: com TOTP errado → bloquear unlock; com certo → liberar.
